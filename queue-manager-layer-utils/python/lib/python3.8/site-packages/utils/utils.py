import json
import base64
import hashlib
import jwt
from time import time

#used to return response to apigateway
def response(body, status_code):
    return {
        'statusCode': status_code,
        'body': json.dumps(body),
        'headers': {
            'Content-Type': 'application/json',
            'Access-Control-Allow-Origin': '*'
        }
    }

#use to encode password (md5+base64)	
def encode_password(password):
    passwordMd5 = hashlib.md5(password.encode()) 
    encodedbase64Bytes = base64.b64encode(passwordMd5.hexdigest().encode("utf-8"))
    encodedbase64 = str(encodedbase64Bytes, "utf-8")
    return encodedbase64;
	
#encode jwt
def jwt_encode(payload, secret, expiration):
    payload = {
      'inf': payload,
      'exp': int(time()) + expiration
    }
    return jwt.encode(payload, secret, algorithm='HS256')
	
#decode jwt
def jwt_decode(token, secret):
    return jwt.decode(token, secret, algorithm='HS256')