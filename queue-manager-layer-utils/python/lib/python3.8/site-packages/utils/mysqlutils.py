import json
import pymysql

CONN_TIMEOUT = 5

#get connection from mysql
def connection(host, user, passoword, db):
    try:
        conn = pymysql.connect(host, user, passoword, db, connect_timeout=CONN_TIMEOUT)
        return conn    
    except Exception as e:
        print("ERROR: Unexpected error: Could not connect to MySQL instance.")
        print(e)
        raise Exception

#execute query
def execute(conn, query, commit=True):
	try:
		cur = conn.cursor()
		cur.execute(query)
		if commit:
			conn.commit()
		rows = cur.fetchall()		
		cur.close()
		return rows
	except Exception as e:
		print("ERROR: Unexpected error: Could execute query.")
		print(query)
		print(e)
		raise Exception