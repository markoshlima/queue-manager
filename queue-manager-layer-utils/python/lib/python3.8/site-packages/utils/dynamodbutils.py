import json
import boto3
from boto3.dynamodb.conditions import Key, Attr

dynamodb = boto3.resource('dynamodb')

# get_item in dynamodb
def get_item(table_name, key):
    try:
        table = dynamodb.Table(table_name)
        response = table.get_item(Key=key)
    except Exception as e:
        print (e)
        raise Exception('Failed to get_item in dynamodb')
    else:
        if 'Item' not in response:
            return False
        return response['Item']


# put_item in dynamodb
def put_item(table_name, item):
    try:
        table = dynamodb.Table(table_name)
        table.put_item(Item=item)
    except Exception as e:
        print (e)
        raise Exception('Failed to put_item in dynamodb')


# delete_item in dynamodb
def delete_item(table_name, key):
    try:
        table = dynamodb.Table(table_name)
        table.delete_item(Key=key)
    except Exception as e:
        print (e)
        raise Exception('Failed to delete_item in dynamodb')

